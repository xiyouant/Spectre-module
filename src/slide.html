<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Slide-test</title>
	<link rel="stylesheet" href="css/slide.css">
</head>
<body>
	<div id="app">
	<div>
		<div class="container">
			<slider></slider>
		</div>
	</div>
		
	</div>
	<template id="slider">
		<div class="slider-wrap">
			<ul class="clearfix slide-animate" v-bind:style='getClass'>
				<li v-for="item in imgData" v-bind:current="current">
					<a href="{{item.href}}"><img v-bind:src="item.imgsrc"/></a>
				</li>
			</ul>
		</div>
		<button v-on:click="turnToPrev" class="btn"><-</button>
		<button v-on:click="turnToNext" class="btn">-></button>
	</template>

	<script type="text/javascript" src='js/vue.js'></script>
	<script type="text/javascript" src="data/slideData.js"></script>
	<script type="text/javascript">
	/**	
		参数： currentLet： 目前应该在的left值
			  count ：列表的长度 -- issue： this.imgData.length 报错。。。

		原理： 通过set currenLeft 的值来改变一个 ul 的位置
	**/
		Vue.component('slider',{
			template: '#slider',
			data: function(){
				return {
					currentIdx: 0,
					currentLeft:0+'px',
					count:imgData.length,
					autoplay:true,
					timer: null, // 用在在点击btn 的时候关掉定时器 不然的话就会出现问题
					imgData: imgData
				}
			},
			computed:{
				getClass:{
					get: function(){
						return{
							width:1920+'px',
							left:this.currentLeft
						}
					},
					set: function(currentIdx){
						this.currentLeft = -640 * currentIdx +'px'
					}
				}
			},
			methods:{
				turn: function(i){
					//首先是让now = 1
					var now = this.currentIdx +i;
					// console.log(now)
					// 如果now == 0 说明是在第一张点击了一个向后的btn  {要么在第一张不动[此处选择0]， 要么返回第三张 --循环显示} 
					if(now < 0){
						now = 0;
						console.log("前面已经没有啦")
					}
					//如果大于等于3 了 然后减去3 就到 0 了
					if(now >=3){
						now = now - this.count;
						// console.log(now)
					}
					this.getClass = now;
					this.currentIdx = now;
				},
				play:function(){	
					var _that = this;
					this.timer = setInterval(function(){
						_that.turn(1)
					},3000);
					console.log("自动轮播中~")
				},
				pause: function(){
					clearInterval(this.timer)
				},
				turnToPrev:function(){
					this.pause();  //先关掉定时器 然后在turn() 然后再重新开启定时器
					this.turn(-1);
					this.play();
				},
				turnToNext: function(){
					this.pause();
					this.turn(1);
					this.play();
				}
			},
			ready: function(){
				this.play();
			}
		})
		new Vue({
			el:'#app',
		})
	</script>
</body>
</html>